
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Mahesh Gavandar">
        <meta name="description" content="Kafka Processors System - Complete Documentation">
        <title>Kafka Processors System - Complete Documentation</title>
        
    <style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    body {
        font-family: 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
        line-height: 1.6;
        color: #333;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
    }
    
    .container {
        max-width: 1200px;
        margin: 0 auto;
        background: white;
        min-height: 100vh;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }
    
    /* Header Navigation */
    .header {
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        color: white;
        padding: 20px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        position: sticky;
        top: 0;
        z-index: 1000;
    }
    
    .header h1 {
        margin: 0;
        font-size: 2.2em;
        text-align: center;
        margin-bottom: 10px;
    }
    
    .nav-links {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 15px;
        flex-wrap: wrap;
    }
    
    .nav-link {
        background: rgba(255,255,255,0.2);
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        border-radius: 20px;
        transition: all 0.3s ease;
        font-weight: 500;
        border: 1px solid rgba(255,255,255,0.3);
    }
    
    .nav-link:hover {
        background: rgba(255,255,255,0.3);
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    
    .nav-link.active {
        background: #ff6b6b;
        border-color: #ff6b6b;
    }
    
    /* Content Area */
    .content {
        padding: 40px;
        background: white;
    }
    
    /* Headings */
    h1 {
        color: #1e3c72;
        border-bottom: 3px solid #1e3c72;
        padding-bottom: 10px;
        margin: 30px 0 20px 0;
        font-size: 2.2em;
        position: relative;
    }
    
    h1:first-child {
        margin-top: 0;
    }
    
    h1::after {
        content: '';
        position: absolute;
        bottom: -3px;
        left: 0;
        width: 50px;
        height: 3px;
        background: #ff6b6b;
    }
    
    h2 {
        color: #2a5298;
        border-bottom: 2px solid #e0e0e0;
        padding-bottom: 8px;
        margin: 25px 0 15px 0;
        font-size: 1.6em;
    }
    
    h3 {
        color: #444;
        margin: 20px 0 10px 0;
        font-size: 1.3em;
    }
    
    h4 {
        color: #666;
        margin: 15px 0 8px 0;
        font-size: 1.1em;
    }
    
    /* Paragraphs */
    p {
        margin: 12px 0;
        text-align: justify;
        line-height: 1.7;
    }
    
    /* Code styling */
    code {
        background: linear-gradient(135deg, #f8f9fa, #e9ecef);
        padding: 3px 6px;
        border-radius: 4px;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 0.9em;
        color: #d63384;
        border: 1px solid #dee2e6;
    }
    
    pre {
        background: linear-gradient(135deg, #2d3748, #4a5568);
        color: #e2e8f0;
        border-radius: 8px;
        padding: 20px;
        overflow-x: auto;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 0.85em;
        line-height: 1.5;
        margin: 20px 0;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        border-left: 4px solid #ff6b6b;
    }
    
    pre code {
        background: none;
        padding: 0;
        color: #e2e8f0;
        border: none;
    }
    
    /* Tables */
    table {
        border-collapse: collapse;
        width: 100%;
        margin: 20px 0;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        border-radius: 8px;
        overflow: hidden;
    }
    
    th {
        background: linear-gradient(135deg, #1e3c72, #2a5298);
        color: white;
        padding: 15px 12px;
        text-align: left;
        font-weight: 600;
        font-size: 0.95em;
    }
    
    td {
        padding: 12px;
        border-bottom: 1px solid #e0e0e0;
        vertical-align: top;
    }
    
    tr:nth-child(even) {
        background: #f8f9fa;
    }
    
    tr:hover {
        background: #e3f2fd;
        transition: background 0.2s ease;
    }
    
    /* Lists */
    ul, ol {
        margin: 15px 0;
        padding-left: 30px;
    }
    
    li {
        margin: 8px 0;
        line-height: 1.6;
    }
    
    ul li::marker {
        color: #2a5298;
    }
    
    ol li::marker {
        color: #2a5298;
        font-weight: bold;
    }
    
    /* Links */
    a {
        color: #2a5298;
        text-decoration: none;
        font-weight: 500;
        transition: color 0.2s ease;
    }
    
    a:hover {
        color: #ff6b6b;
        text-decoration: underline;
    }
    
    /* Blockquotes */
    blockquote {
        border-left: 5px solid #ff6b6b;
        margin: 20px 0;
        padding: 15px 25px;
        background: linear-gradient(135deg, #fff5f5, #fed7d7);
        font-style: italic;
        border-radius: 0 8px 8px 0;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    /* Status badges */
    .badge {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.8em;
        font-weight: 600;
        margin: 2px;
    }
    
    .badge-success { background: #d4edda; color: #155724; }
    .badge-warning { background: #fff3cd; color: #856404; }
    .badge-error { background: #f8d7da; color: #721c24; }
    .badge-info { background: #d1ecf1; color: #0c5460; }
    
    /* Footer */
    .footer {
        background: linear-gradient(135deg, #2d3748, #4a5568);
        color: white;
        padding: 30px;
        text-align: center;
        margin-top: 50px;
    }
    
    .footer h3 {
        color: #ff6b6b;
        margin-bottom: 10px;
        font-size: 1.2em;
    }
    
    .footer p {
        margin: 8px 0;
        opacity: 0.9;
    }
    
    .footer .developer {
        background: rgba(255,255,255,0.1);
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        border: 1px solid rgba(255,255,255,0.2);
    }
    
    .footer .developer strong {
        color: #ff6b6b;
        font-size: 1.1em;
    }
    
    /* Back to top button */
    .back-to-top {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
        color: white;
        padding: 12px;
        border-radius: 50%;
        text-decoration: none;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        transition: all 0.3s ease;
        z-index: 1000;
        width: 50px;
        height: 50px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
    }
    
    .back-to-top:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 16px rgba(0,0,0,0.4);
        background: linear-gradient(135deg, #ee5a5a, #dc4545);
    }
    
    /* Responsive design */
    @media (max-width: 768px) {
        .content {
            padding: 20px;
        }
        
        .header {
            padding: 15px;
        }
        
        .header h1 {
            font-size: 1.8em;
        }
        
        .nav-links {
            gap: 10px;
        }
        
        .nav-link {
            padding: 6px 12px;
            font-size: 0.9em;
        }
        
        h1 {
            font-size: 1.8em;
        }
        
        h2 {
            font-size: 1.4em;
        }
        
        table {
            font-size: 0.9em;
        }
        
        pre {
            padding: 15px;
            font-size: 0.8em;
        }
    }
    
    /* Print styles */
    @media print {
        body {
            background: white;
        }
        
        .header, .footer, .back-to-top {
            display: none;
        }
        
        .container {
            box-shadow: none;
        }
        
        .content {
            padding: 0;
        }
        
        h1 {
            page-break-before: always;
        }
        
        h1:first-child {
            page-break-before: avoid;
        }
        
        pre, table, blockquote {
            page-break-inside: avoid;
        }
    }
    </style>
    
    </head>
    <body>
        <div class="container">
            <header class="header">
                <h1>ğŸš€ Kafka Processors System</h1>
                <p style="text-align: center; margin: 5px 0; opacity: 0.9; font-size: 1.1em;">Complete Documentation</p>
                
        <div class="nav-links">
            <a href="Kafka_Processors_System_Documentation.html" class="nav-link active">ğŸ“‹ Complete Documentation</a>
            <a href="File_Structure_Guide.html" class="nav-link">ğŸ“ File Structure Guide</a>
            <a href="#system-overview" class="nav-link">ğŸ—ï¸ Architecture</a>
            <a href="#api-documentation" class="nav-link">ğŸ”Œ API Docs</a>
            <a href="#docker-setup" class="nav-link">ğŸ³ Docker Setup</a>
            <a href="http://195.35.6.88:8082" class="nav-link" target="_blank">ğŸš€ Live API</a>
            <a href="http://195.35.6.88:8082/docs" class="nav-link" target="_blank">ğŸ“– API Swagger</a>
        </div>
        
            </header>
            
            <main class="content">
                <h1 id="kafka-processors-system-complete-documentation">Kafka Processors System - Complete Documentation</h1>

<h2 id="table-of-contents">Table of Contents</h2>

<ol>
<li><a href="#system-overview">System Overview</a></li>
<li><a href="#architecture">Architecture</a></li>
<li><a href="#installation-guide">Installation Guide</a></li>
<li><a href="#project-structure">Project Structure</a></li>
<li><a href="#file-descriptions">File Descriptions</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#topic-management">Topic Management</a></li>
<li><a href="#api-documentation">API Documentation</a></li>
<li><a href="#processor-details">Processor Details</a></li>
<li><a href="#docker-setup">Docker Setup</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
<li><a href="#examples">Examples</a></li>
</ol>

<hr />

<h2 id="system-overview">System Overview</h2>

<p><strong>Developer: Mahesh Gavandar | Version 3.0.0 | Date: November 2, 2025</strong></p>

<p>The Kafka Processors System is a comprehensive, production-ready message processing platform built with Apache Kafka, Python, and FastAPI. Now featuring complete Docker containerization and advanced health monitoring capabilities.</p>

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px; margin: 20px 0;">
<h4>ğŸ†• Version 3.0.0 New Features:</h4>
<ul style="margin: 10px 0 0 20px;">
<li>ğŸ³ <strong>Complete Docker Support</strong> - Full containerization with Docker Compose</li>
<li>â¤ï¸ <strong>Advanced Health Monitoring</strong> - Real-time system and processor health checks</li>
<li>ğŸ”„ <strong>Auto-Recovery System</strong> - Automatic restart and failure detection</li>
<li>ğŸŒ <strong>Web Interfaces</strong> - Kafka UI and integrated documentation servers</li>
<li>ğŸ“Š <strong>Enhanced Logging</strong> - Centralized logging and monitoring dashboards</li>
<li>ğŸ›¡ï¸ <strong>Production Readiness</strong> - Persistent storage, graceful shutdown, and resource management</li>
</ul>
</div>

<p>The system provides:</p>

<ul>
<li><strong>Real-time message processing</strong> with concurrent handling</li>
<li><strong>REST API</strong> for sending events to Kafka topics</li>
<li><strong>Three specialized processors</strong> for different business operations</li>
<li><strong>Docker containerization</strong> for easy deployment and scaling</li>
<li><strong>Thread-safe concurrent processing</strong> with configurable workers</li>
<li><strong>Comprehensive logging and monitoring</strong> with health endpoints</li>
<li><strong>Web-based management interfaces</strong> for Kafka and documentation</li>
</ul>

<h3 id="key-features">Key Features</h3>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
<h4>ğŸ”§ Core Processing</h4>
<ul>
<li>âœ… Concurrent message processing (multiple threads per processor)</li>
<li>âœ… Thread-safe Kafka producer/consumer wrappers</li>
<li>âœ… Batch processing capabilities with configurable batch sizes</li>
<li>âœ… Sequential pipeline processing for server decommissioning</li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #007bff;">
<h4>ğŸŒ API & Interfaces</h4>
<ul>
<li>âœ… REST API with automatic OpenAPI documentation</li>
<li>âœ… Interactive Swagger UI at /docs endpoint</li>
<li>âœ… Health monitoring endpoints (/health, /health/processors)</li>
<li>âœ… Web-based Kafka management interface</li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #6f42c1;">
<h4>ğŸ³ Deployment & Operations</h4>
<ul>
<li>âœ… Complete Docker containerization with Docker Compose</li>
<li>âœ… One-click deployment with automated setup scripts</li>
<li>âœ… Container health checks and auto-restart capabilities</li>
<li>âœ… Persistent data storage with Docker volumes</li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #fd7e14;">
<h4>ğŸ“Š Monitoring & Management</h4>
<ul>
<li>âœ… Real-time processor status tracking</li>
<li>âœ… Comprehensive error handling and logging</li>
<li>âœ… Configuration management with environment variable support</li>
<li>âœ… Centralized logging with container log aggregation</li>
</ul>
</div>
</div>

<hr />

<h2 id="architecture">Architecture</h2>

<h3 id="high-level-architecture">High-Level Architecture (Docker Containerized)</h3>

<pre style="background: #f8f9fa; padding: 15px; border-radius: 8px; overflow-x: auto;"><code>
ğŸ³ Docker Container Environment
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client/Web    â”‚â”€â”€â”€â–¶â”‚  API Container  â”‚â”€â”€â”€â–¶â”‚ Kafka Container â”‚â”€â”€â”€â–¶â”‚Processor Managerâ”‚
â”‚                 â”‚    â”‚   (Port 8082)   â”‚    â”‚   (Port 9092)   â”‚    â”‚   (3 Workers)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚                       â”‚
         â”‚                       â”‚                       â”‚                       â–¼
         â”‚                       â”‚                       â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                       â”‚                       â”‚              â”‚ Health Monitor  â”‚
         â”‚                       â”‚                       â”‚              â”‚ Status Tracking â”‚
         â”‚                       â”‚                       â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Documentation  â”‚    â”‚   Health API    â”‚    â”‚   Kafka UI      â”‚
â”‚   (Port 8090)   â”‚    â”‚ /health/proc... â”‚    â”‚   (Port 8080)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    Zookeeper Container  â”‚
                    â”‚      (Port 2181)        â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š Service Access Points:
â€¢ API Server: http://localhost:8082
â€¢ Health Check: http://localhost:8082/health  
â€¢ Processor Status: http://localhost:8082/health/processors
â€¢ API Documentation: http://localhost:8082/docs
â€¢ Kafka Management: http://localhost:8080
â€¢ Documentation Hub: http://localhost:8090
</code></pre>

<h3 id="message-flow">Message Flow</h3>

<ol>
<li><strong>Client</strong> sends HTTP request to REST API</li>
<li><strong>API</strong> validates request and publishes to <code>details-input</code> topic</li>
<li><strong>Processors</strong> consume from <code>details-input</code> topic concurrently</li>
<li><strong>Business Logic</strong> executes based on message action type</li>
<li><strong>Results</strong> are published to <code>details-output</code> topic</li>
<li><strong>Monitoring</strong> systems can consume from output topic</li>
</ol>

<h3 id="components">System Components</h3>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin: 20px 0;">

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px;">
<h4>ğŸ³ Container Infrastructure</h4>
<ul style="margin: 10px 0 0 20px;">
<li><strong>kafka-processors</strong>: Main application container (API + Processors)</li>
<li><strong>kafka</strong>: Confluent Kafka broker with JMX monitoring</li>
<li><strong>zookeeper</strong>: Kafka coordination service</li>
<li><strong>kafka-ui</strong>: Web-based Kafka management interface</li>
<li><strong>docs-server</strong>: Documentation web server</li>
</ul>
</div>

<div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; padding: 15px; border-radius: 8px;">
<h4>âš™ï¸ Core Application Components</h4>
<ul style="margin: 10px 0 0 20px;">
<li><strong>REST API</strong>: FastAPI-based HTTP interface with auto-docs</li>
<li><strong>Processor Manager</strong>: Orchestrates all message processors</li>
<li><strong>Health Monitor</strong>: Real-time system and processor status</li>
<li><strong>Kafka Manager</strong>: Thread-safe Kafka client wrapper</li>
<li><strong>Configuration System</strong>: JSON-based config with env overrides</li>
</ul>
</div>

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 8px;">
<h4>ğŸ“Š Processing Pipeline</h4>
<p style="margin: 10px 0; font-size: 1.1em;"><strong>Pipeline Flow:</strong> API â†’ check_server â†’ poweroff_server â†’ cooling_period â†’ demise_server â†’ complete</p>
<ul style="margin: 10px 0 0 20px;">
<li><strong>1ï¸âƒ£ ServerCheckProcessor</strong>: Validates server information in portal</li>
<li><strong>2ï¸âƒ£ ServerPowerOffProcessor</strong>: Handles server power-off operations</li>
<li><strong>2ï¸âƒ£.5ï¸âƒ£ ServerCoolingPeriodProcessor</strong>: 48-hour cooling period with monitoring</li>
<li><strong>3ï¸âƒ£ ServerDemiseProcessor</strong>: Executes final server decommissioning</li>
<li><strong>Topic Manager</strong>: Handles Kafka topic operations</li>
<li><strong>Message Router</strong>: Routes messages to appropriate processors</li>
</ul>
</div>

<div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; padding: 15px; border-radius: 8px;">
<h4>ğŸ›¡ï¸ Monitoring & Management</h4>
<ul style="margin: 10px 0 0 20px;">
<li><strong>Health API</strong>: System health endpoints (/health, /health/processors)</li>
<li><strong>Docker Health Checks</strong>: Container-level health monitoring</li>
<li><strong>Status Tracking</strong>: Real-time processor status files</li>
<li><strong>Log Aggregation</strong>: Centralized logging system</li>
<li><strong>Auto-restart</strong>: Automatic failure recovery</li>
</ul>
</div>

</div>

<hr />

<h2 id="installation-guide">Installation Guide</h2>

<h3 id="prerequisites">Prerequisites</h3>

<ul>
<li><strong>Docker &amp; Docker Compose</strong> (recommended) OR</li>
<li><strong>Java 17+</strong> (for local Kafka installation)</li>
<li><strong>Python 3.8+</strong></li>
<li><strong>pip</strong> (Python package manager)</li>
</ul>

<h3 id="option-1-docker-installation-recommended">Option 1: Docker Installation (Recommended)</h3>

<pre><code># Navigate to project directory
cd /root/kafka/kafka-processors

# Build and start all services
./docker-manage.sh build
./docker-manage.sh up

# Create Kafka topics
./setup-topics.sh

# Test the system
./docker-manage.sh test
</code></pre>

<h3 id="option-2-local-installation">Option 2: Local Installation</h3>

<pre><code># 1. Install Kafka (already done in /root/kafka/)
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-17.0.16.0.8-2.el8.x86_64

# Start Zookeeper
cd /root/kafka
nohup bin/zookeeper-server-start.sh config/zookeeper.properties &gt; logs/zookeeper.log 2&gt;&amp;1 &amp;

# Start Kafka
nohup bin/kafka-server-start.sh config/server.properties &gt; logs/kafka.log 2&gt;&amp;1 &amp;

# 2. Install Python dependencies
cd /root/kafka/kafka-processors
pip install -r requirements.txt

# 3. Start processors and API
./start_all.sh
</code></pre>

<hr />

<h2 id="project-structure">Project Structure</h2>

<pre><code>/root/kafka/kafka-processors/
â”œâ”€â”€ api/
â”‚   â””â”€â”€ main.py                      # FastAPI REST API server
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ __init__.py                  # Configuration management classes
â”‚   â”œâ”€â”€ config.json                  # Main configuration file
â”‚   â””â”€â”€ config.docker.json           # Docker-specific configuration
â”œâ”€â”€ processors/
â”‚   â”œâ”€â”€ __init__.py                  # Processor module exports
â”‚   â”œâ”€â”€ base_processor.py            # Abstract base processor class
â”‚   â”œâ”€â”€ show_details_processor.py    # Show details business logic
â”‚   â”œâ”€â”€ update_details_processor.py  # Update details business logic
â”‚   â””â”€â”€ create_details_processor.py  # Create details business logic
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py                  # Utility module exports
â”‚   â””â”€â”€ kafka_manager.py             # Kafka producer/consumer wrappers
â”œâ”€â”€ logs/                            # Application log files
â”‚   â””â”€â”€ kafka-processors.log         # Main application log
â”œâ”€â”€ Dockerfile                       # Docker container definition
â”œâ”€â”€ docker-compose.yml               # Multi-service Docker orchestration
â”œâ”€â”€ .dockerignore                    # Docker build ignore patterns
â”œâ”€â”€ docker-manage.sh                 # Docker management utility
â”œâ”€â”€ setup-topics.sh                  # Kafka topic creation script
â”œâ”€â”€ start_all.sh                     # Local system startup script
â”œâ”€â”€ processor_manager.py             # Main processor orchestrator
â”œâ”€â”€ test_system.py                   # Comprehensive test suite
â”œâ”€â”€ requirements.txt                 # Python dependencies
â””â”€â”€ README.md                        # Project documentation
</code></pre>

<hr />

<h2 id="file-descriptions">File Descriptions</h2>

<h3 id="core-application-files">Core Application Files</h3>

<h4 id="processor_managerpy"><code>processor_manager.py</code></h4>

<p><strong>Purpose</strong>: Main entry point that orchestrates all Kafka processors
<strong>Key Functions</strong>:
- Initializes all three processors (show, update, create)
- Manages Kafka consumers with configurable thread pools
- Handles graceful shutdown with signal handling
- Routes incoming messages to appropriate processors</p>

<h4 id="apimainpy"><code>api/main.py</code></h4>

<p><strong>Purpose</strong>: FastAPI REST API server for receiving HTTP requests
<strong>Key Features</strong>:
- <code>/send-event</code> endpoint for single message processing
- <code>/send-batch</code> endpoint for bulk message processing
- <code>/health</code> endpoint for system health monitoring
- Automatic OpenAPI documentation generation
- Request validation with Pydantic models</p>

<h3 id="processor-files">Processor Files</h3>

<h4 id="processorsbase_processorpy"><code>processors/base_processor.py</code></h4>

<p><strong>Purpose</strong>: Abstract base class defining processor interface
<strong>Key Methods</strong>:
- <code>process_message()</code>: Main message processing workflow
- <code>_should_process()</code>: Abstract method for message filtering
- <code>_process_business_logic()</code>: Abstract method for business logic
- <code>_create_response()</code>: Standardized response formatting</p>

<h4 id="processorsshow_details_processorpy"><code>processors/show_details_processor.py</code></h4>

<p><strong>Purpose</strong>: Handles <code>show_details</code> action messages
<strong>Business Logic</strong>:
- Simulates database record retrieval
- Adds metadata and processing timestamps
- Returns structured record information</p>

<h4 id="processorsupdate_details_processorpy"><code>processors/update_details_processor.py</code></h4>

<p><strong>Purpose</strong>: Handles <code>update_details</code> action messages<br />
<strong>Business Logic</strong>:
- Validates update data requirements
- Simulates database record updates
- Tracks version numbers and update history
- Performs field-level validation</p>

<h4 id="processorscreate_details_processorpy"><code>processors/create_details_processor.py</code></h4>

<p><strong>Purpose</strong>: Handles <code>create_details</code> action messages
<strong>Business Logic</strong>:
- Validates required fields for new records
- Generates unique record identifiers
- Simulates database record creation
- Adds computed fields and metadata</p>

<h3 id="utility-files">Utility Files</h3>

<h4 id="utilskafka_managerpy"><code>utils/kafka_manager.py</code></h4>

<p><strong>Purpose</strong>: Thread-safe Kafka client management
<strong>Key Classes</strong>:
- <code>KafkaProducerWrapper</code>: Thread-safe message publishing
- <code>KafkaConsumerWrapper</code>: Concurrent message consumption
- <code>KafkaManager</code>: Unified producer/consumer management</p>

<h4 id="config__init__py"><code>config/__init__.py</code></h4>

<p><strong>Purpose</strong>: Configuration management system
<strong>Key Features</strong>:
- JSON configuration file loading
- Environment variable overrides for Docker
- Type-safe configuration access methods</p>

<h3 id="configuration-files">Configuration Files</h3>

<h4 id="configconfigjson"><code>config/config.json</code></h4>

<p><strong>Purpose</strong>: Main application configuration
<strong>Sections</strong>:
- Kafka connection settings
- Topic names and partitioning
- Processor thread configuration
- API server settings
- Logging configuration</p>

<h4 id="requirementstxt"><code>requirements.txt</code></h4>

<p><strong>Purpose</strong>: Python package dependencies
<strong>Key Dependencies</strong>:
- <code>kafka-python</code>: Kafka client library
- <code>fastapi</code>: REST API framework
- <code>uvicorn</code>: ASGI server
- <code>pydantic</code>: Data validation</p>

<h3 id="docker-files">Docker Files</h3>

<h4 id="dockerfile"><code>Dockerfile</code></h4>

<p><strong>Purpose</strong>: Container image definition
<strong>Features</strong>:
- Multi-stage build optimization
- Java and Python runtime setup
- Health check configuration
- Startup script integration</p>

<h4 id="docker-composeyml"><code>docker-compose.yml</code></h4>

<p><strong>Purpose</strong>: Multi-service orchestration
<strong>Services</strong>:
- <code>zookeeper</code>: Kafka coordination service
- <code>kafka</code>: Message broker
- <code>kafka-ui</code>: Web-based Kafka management
- <code>kafka-processors</code>: Main application</p>

<h3 id="utility-scripts">Utility Scripts</h3>

<h4 id="docker-managesh"><code>docker-manage.sh</code></h4>

<p><strong>Purpose</strong>: Docker container management utility
<strong>Commands</strong>:
- <code>build</code>: Build Docker images
- <code>up</code>/<code>down</code>: Start/stop services
- <code>logs</code>: View service logs
- <code>status</code>: Check service health
- <code>clean</code>: Remove containers and volumes</p>

<h4 id="setup-topicssh"><code>setup-topics.sh</code></h4>

<p><strong>Purpose</strong>: Kafka topic creation for Docker environment
<strong>Functions</strong>:
- Creates <code>details-input</code> topic with 3 partitions
- Creates <code>details-output</code> topic with 3 partitions
- Verifies topic creation success</p>

<h4 id="start_allsh"><code>start_all.sh</code></h4>

<p><strong>Purpose</strong>: Local development startup script
<strong>Functions</strong>:
- Starts processor manager in background
- Starts FastAPI server on port 8082
- Displays service URLs and management info</p>

<h4 id="test_systempy"><code>test_system.py</code></h4>

<p><strong>Purpose</strong>: Comprehensive system testing
<strong>Test Cases</strong>:
- API health verification
- Individual processor testing
- Batch processing validation
- Error handling verification</p>

<hr />

<h2 id="configuration">Configuration</h2>

<h3 id="main-configuration-configconfigjson">Main Configuration (<code>config/config.json</code>)</h3>

<pre><code>{
    "kafka": {
        "bootstrap_servers": ["localhost:9092"],
        "client_id": "kafka-processors",
        "group_id": "details-processor-group",
        "auto_offset_reset": "earliest",
        "enable_auto_commit": true,
        "auto_commit_interval_ms": 1000,
        "session_timeout_ms": 30000,
        "max_poll_records": 100,
        "max_poll_interval_ms": 300000,
        "consumer_timeout_ms": 5000
    },
    "topics": {
        "input": "details-input",
        "output": "details-output"
    },
    "processors": {
        "show_details": {
            "enabled": true,
            "threads": 2
        },
        "update_details": {
            "enabled": true,
            "threads": 2
        },
        "create_details": {
            "enabled": true,
            "threads": 2
        }
    },
    "api": {
        "host": "0.0.0.0",
        "port": 8082,
        "debug": true
    },
    "logging": {
        "level": "INFO",
        "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s",
        "file": "logs/kafka-processors.log"
    }
}
</code></pre>

<h3 id="configuration-parameters">Configuration Parameters</h3>

<h4 id="kafka-settings">Kafka Settings</h4>

<ul>
<li><code>bootstrap_servers</code>: Kafka broker addresses</li>
<li><code>group_id</code>: Consumer group identifier</li>
<li><code>auto_offset_reset</code>: Offset reset strategy ("earliest" or "latest")</li>
<li><code>max_poll_records</code>: Maximum records per poll operation</li>
<li><code>consumer_timeout_ms</code>: Consumer polling timeout</li>
</ul>

<h4 id="topic-configuration">Topic Configuration</h4>

<ul>
<li><code>input</code>: Topic name for incoming messages</li>
<li><code>output</code>: Topic name for processed results</li>
</ul>

<h4 id="processor-settings">Processor Settings</h4>

<ul>
<li><code>enabled</code>: Enable/disable individual processors</li>
<li><code>threads</code>: Thread pool size per processor type</li>
</ul>

<h4 id="api-configuration">API Configuration</h4>

<ul>
<li><code>host</code>: API server bind address</li>
<li><code>port</code>: API server port (8082 to avoid conflicts)</li>
<li><code>debug</code>: Enable debug mode with auto-reload</li>
</ul>

<hr />

<h2 id="topic-management">Topic Management</h2>

<h3 id="current-topics">Current Topics</h3>

<h4 id="details-input"><code>details-input</code></h4>

<ul>
<li><strong>Purpose</strong>: Receives incoming messages from REST API</li>
<li><strong>Partitions</strong>: 3 (for load distribution)</li>
<li><strong>Replication Factor</strong>: 1 (single broker setup)</li>
<li><strong>Key Strategy</strong>: Message ID for consistent routing</li>
</ul>

<h4 id="details-output"><code>details-output</code></h4>

<ul>
<li><strong>Purpose</strong>: Stores processed results from processors</li>
<li><strong>Partitions</strong>: 3 (matching input topic)</li>
<li><strong>Replication Factor</strong>: 1</li>
<li><strong>Key Strategy</strong>: Original message ID for traceability</li>
</ul>

<h3 id="modifying-existing-topics">Modifying Existing Topics</h3>

<p>If you need to change topic configuration, modify these files:</p>

<h4 id="1-update-configuration">1. Update Configuration</h4>

<p><strong>File</strong>: <code>config/config.json</code></p>

<pre><code>{
    "topics": {
        "input": "your-new-input-topic",
        "output": "your-new-output-topic"
    }
}
</code></pre>

<h4 id="2-create-new-topics-local-installation">2. Create New Topics (Local Installation)</h4>

<p><strong>Command</strong>:</p>

<pre><code>cd /root/kafka
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-17.0.16.0.8-2.el8.x86_64

# Create new input topic
bin/kafka-topics.sh --create --topic your-new-input-topic \
    --bootstrap-server localhost:9092 \
    --partitions 3 --replication-factor 1

# Create new output topic
bin/kafka-topics.sh --create --topic your-new-output-topic \
    --bootstrap-server localhost:9092 \
    --partitions 3 --replication-factor 1
</code></pre>

<h4 id="3-update-docker-topic-creation">3. Update Docker Topic Creation</h4>

<p><strong>File</strong>: <code>setup-topics.sh</code></p>

<pre><code># Update topic names in the script
docker-compose exec kafka kafka-topics --create \
    --topic your-new-input-topic \
    --bootstrap-server localhost:9092 \
    --partitions 3 --replication-factor 1 --if-not-exists
</code></pre>

<h4 id="4-update-test-scripts">4. Update Test Scripts</h4>

<p><strong>File</strong>: <code>test_system.py</code></p>

<pre><code># Update API base URL if needed
API_BASE_URL = "http://localhost:8082"
</code></pre>

<h3 id="adding-new-topics">Adding New Topics</h3>

<p>To add additional topics for new processors:</p>

<ol>
<li><strong>Add to configuration</strong>:</li>
</ol>

<pre><code>{
    "topics": {
        "input": "details-input",
        "output": "details-output",
        "notifications": "notification-events",
        "analytics": "analytics-events"
    }
}
</code></pre>

<ol start="2">
<li><p><strong>Create topics</strong> using Kafka command-line tools or update <code>setup-topics.sh</code></p></li>
<li><p><strong>Update processors</strong> to use new topics as needed</p></li>
</ol>

<hr />

<h2 id="api-documentation">ğŸ”Œ API Documentation</h2>

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin: 20px 0;">
<h3>ğŸš€ FastAPI with Auto-Documentation</h3>
<p>The API now includes comprehensive health monitoring endpoints along with the core processing functionality. All endpoints are documented with OpenAPI/Swagger.</p>
</div>

<h3 id="base-url">ğŸŒ Base URLs & Access Points</h3>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin: 20px 0;">

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #007bff;">
<h4>ğŸ”— API Access</h4>
<ul>
<li><strong>Local/Docker</strong>: <a href="http://localhost:8082">http://localhost:8082</a></li>
<li><strong>Production</strong>: <a href="http://195.35.6.88:8082">http://195.35.6.88:8082</a></li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
<h4>ğŸ“– Documentation</h4>
<ul>
<li><strong>Swagger UI</strong>: <a href="http://localhost:8082/docs">/docs</a></li>
<li><strong>OpenAPI JSON</strong>: <a href="http://localhost:8082/openapi.json">/openapi.json</a></li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #dc3545;">
<h4>â¤ï¸ Health Monitoring</h4>
<ul>
<li><strong>System Health</strong>: <a href="http://localhost:8082/health">/health</a></li>
<li><strong>Processor Health</strong>: <a href="http://localhost:8082/health/processors">/health/processors</a></li>
</ul>
</div>

</div>

<h3 id="endpoints">ğŸ¯ API Endpoints</h3>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
<h4>ğŸ“‹ Endpoint Overview</h4>
<table style="width: 100%; border-collapse: collapse;">
<tr style="background: #e9ecef; font-weight: bold;">
<td style="padding: 8px; border: 1px solid #dee2e6;">Method</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Endpoint</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Purpose</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Type</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid #dee2e6;">GET</td>
<td style="padding: 8px; border: 1px solid #dee2e6;"><code>/</code></td>
<td style="padding: 8px; border: 1px solid #dee2e6;">API information</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Info</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid #dee2e6;">GET</td>
<td style="padding: 8px; border: 1px solid #dee2e6;"><code>/health</code></td>
<td style="padding: 8px; border: 1px solid #dee2e6;">System health check</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Health</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid #dee2e6;">GET</td>
<td style="padding: 8px; border: 1px solid #dee2e6;"><code>/health/processors</code></td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Processor status check</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Health</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid #dee2e6;">POST</td>
<td style="padding: 8px; border: 1px solid #dee2e6;"><code>/send-event</code></td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Send single event</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Processing</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid #dee2e6;">POST</td>
<td style="padding: 8px; border: 1px solid #dee2e6;"><code>/send-batch</code></td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Send multiple events</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Processing</td>
</tr>
<tr>
<td style="padding: 8px; border: 1px solid #dee2e6;">GET</td>
<td style="padding: 8px; border: 1px solid #dee2e6;"><code>/config</code></td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Get configuration</td>
<td style="padding: 8px; border: 1px solid #dee2e6;">Info</td>
</tr>
</table>
</div>

<h4 id="get">ğŸ“ GET <code>/</code></h4>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #17a2b8;">
<p><strong>Purpose</strong>: API information and available endpoints</p>
<p><strong>Updated Response (Version 3.0.0)</strong>:</p>

<pre style="background: #e9ecef; padding: 10px; border-radius: 4px; overflow-x: auto;"><code>{
    "name": "Kafka Processors API",
    "version": "1.0.0",
    "description": "REST API for sending events to Kafka processors",
    "endpoints": {
        "health": "/health",
        "processor_health": "/health/processors",
        "send_event": "/send-event",
        "send_batch": "/send-batch",
        "config": "/config",
        "docs": "/docs"
    }
}
</code></pre>
</div>

<h4 id="get-health">â¤ï¸ GET <code>/health</code> - Comprehensive System Health</h4>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
<p><strong>Purpose</strong>: Comprehensive system health check including Kafka, processors, and API</p>
<p><strong>Features</strong>:</p>
<ul>
<li>âœ… Tests Kafka broker connectivity</li>
<li>âœ… Checks processor manager status</li>
<li>âœ… Validates API server health</li>
<li>âœ… Returns overall system status</li>
</ul>

<p><strong>Enhanced Response (Version 3.0.0)</strong>:</p>

<pre style="background: #e9ecef; padding: 10px; border-radius: 4px; overflow-x: auto;"><code>{
    "status": "healthy",
    "timestamp": "2025-11-02T14:35:39.627170",
    "services": {
        "kafka": "healthy",
        "processors": "healthy",
        "api": "healthy"
    }
}
</code></pre>

<p><strong>Status Values</strong>:</p>
<ul>
<li><code>healthy</code> - All systems operational</li>
<li><code>degraded</code> - Some issues detected</li>
<li><code>unhealthy</code> - Critical problems found</li>
</ul>
</div>

<h4 id="get-health-processors">âš™ï¸ GET <code>/health/processors</code> - Processor Status Check</h4>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #007bff;">
<p><strong>Purpose</strong>: Dedicated Kafka processor manager health check</p>
<p><strong>Features</strong>:</p>
<ul>
<li>ğŸ” Real-time processor status monitoring</li>
<li>ğŸ“Š Process ID and thread count tracking</li>
<li>â° Start time and uptime calculation</li>
<li>ğŸ”„ Heartbeat timestamp verification</li>
</ul>

<p><strong>Response Example</strong>:</p>

<pre style="background: #e9ecef; padding: 10px; border-radius: 4px; overflow-x: auto;"><code>{
    "status": "healthy",
    "timestamp": "2025-11-02T14:35:39.652052",
    "processor_status": "healthy",
    "processor_info": {
        "status": "running",
        "pid": 3815914,
        "timestamp": "2025-11-02T14:35:25.218260",
        "start_time": "2025-11-02T14:35:24.580216",
        "processors": 3,
        "executor_active": true
    },
    "message": "Kafka processors are running normally"
}
</code></pre>

<p><strong>Processor Status Values</strong>:</p>
<ul>
<li><code>healthy</code> - All processors running normally</li>
<li><code>starting</code> - Processors initializing</li>
<li><code>stopping</code> - Graceful shutdown in progress</li>
<li><code>degraded</code> - Running but with issues</li>
<li><code>not_running</code> - No processor manager detected</li>
<li><code>stale</code> - Status file outdated (>60 seconds)</li>
</ul>
</div>

<h4 id="post-send-event">POST <code>/send-event</code></h4>

<p><strong>Purpose</strong>: Send single event for processing
<strong>Request Body</strong>:</p>

<pre><code>{
    "action": "show_details|update_details|create_details",
    "data": {
        "name": "Record Name",
        "description": "Record Description"
    },
    "id": "optional-message-id"
}
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code>{
    "message_id": "generated-uuid",
    "status": "sent",
    "message": "Event sent successfully for processing. Action: show_details",
    "timestamp": "2024-11-02T12:00:00.000000"
}
</code></pre>

<h4 id="post-send-batch">POST <code>/send-batch</code></h4>

<p><strong>Purpose</strong>: Send multiple events for processing
<strong>Request Body</strong>:</p>

<pre><code>[
    {
        "action": "create_details",
        "data": {"name": "Record 1"}
    },
    {
        "action": "show_details",
        "data": {"name": "Record 2"}
    }
]
</code></pre>

<p><strong>Response</strong>:</p>

<pre><code>{
    "total_events": 2,
    "successful": 2,
    "failed": 0,
    "results": [
        {
            "message_id": "uuid-1",
            "status": "sent",
            "message": "Event sent for action: create_details"
        }
    ],
    "timestamp": "2024-11-02T12:00:00.000000"
}
</code></pre>

<h4 id="get-config">GET <code>/config</code></h4>

<p><strong>Purpose</strong>: Get current API configuration (non-sensitive)
<strong>Response</strong>:</p>

<pre><code>{
    "kafka": {
        "topics": {
            "input": "details-input",
            "output": "details-output"
        },
        "bootstrap_servers": ["localhost:9092"]
    },
    "api": {
        "host": "0.0.0.0",
        "port": 8082,
        "debug": true
    },
    "processors": {
        "show_details": {"enabled": true},
        "update_details": {"enabled": true},
        "create_details": {"enabled": true}
    }
}
</code></pre>

<hr />

<h2 id="processor-details">Processor Details</h2>

<h3 id="server-demise-pipeline">Server Demise Pipeline Workflow</h3>

<p>The Server Demise Pipeline processes server decommissioning requests through a sequential 4-stage pipeline:</p>

<div style="background: #f8f9fa; border-left: 4px solid #007bff; padding: 15px; margin: 20px 0;">
<strong>Pipeline Flow:</strong> API â†’ check_server â†’ poweroff_server â†’ cooling_period â†’ demise_server â†’ complete
</div>

<ol>
<li><strong>Message Reception</strong>: API receives server demise request and publishes to Kafka</li>
<li><strong>Server Check</strong>: Validates server exists in portal and is eligible for demise</li>
<li><strong>Power Off</strong>: Safely powers down the server via IPMI/BMC</li>
<li><strong>Cooling Period</strong>: Enforces 48-hour cooling period with power monitoring</li>
<li><strong>Demise Execution</strong>: Performs final server decommissioning</li>
<li><strong>Pipeline Completion</strong>: Sends final status and cleans up resources</li>
</ol>

<h3 id="standardized-message-format">Standardized Message Format</h3>

<h4 id="input-message-format">Input Message Format</h4>

<pre><code>{
    "id": "unique-message-id",
    "action": "check_server|poweroff_server|start_cooling_period|demise_server",
    "status": "pending",
    "data": {
        "server_id": "SRV-12345",
        "server_details": {
            "hostname": "server.datacenter.com",
            "ip_address": "192.168.1.100",
            "location": "DC1-Rack-15-U20"
        },
        "original_request": {
            "requested_by": "admin@company.com",
            "reason": "End of lifecycle"
        }
    },
    "timestamp": "2025-11-02T12:00:00.000000",
    "source": "rest_api"
}
</code></pre>

<h4 id="output-message-format">Output Message Format</h4>

<pre><code>{
    "id": "response-message-id",
    "original_request_id": "original-message-id",
    "action": "demise_complete",
    "status": "success|error|pending",
    "processor": "ServerDemiseProcessor", 
    "processor_id": "processor-instance-uuid",
    "timestamp": "2025-11-02T12:00:00.000000",
    "data": {
        "server_id": "SRV-12345",
        "demise_result": {
            "portal_updated": true,
            "assets_transferred": true,
            "cleanup_completed": true
        }
    },
    "message": "Server demise completed successfully",
    "pipeline_step": 3,
    "pipeline_complete": true
}
</code></pre>

<h3 id="server-check-processor">1ï¸âƒ£ Server Check Processor</h3>

<h4 id="purpose">Purpose</h4>

<p>Validates server information in the portal and verifies eligibility for decommissioning process.</p>

<h4 id="input-data-requirements">Input Data Requirements</h4>

<ul>
<li><code>server_id</code> (required): Unique server identifier</li>
<li><code>server_details</code> (optional): Server metadata (hostname, IP, location)</li>
<li><code>original_request</code> (optional): Request context and requester information</li>
</ul>

<h4 id="processing-logic">Processing Logic</h4>

<ol>
<li>Validates server exists in portal system</li>
<li>Checks server status and eligibility for demise</li>
<li>Verifies no active services or dependencies</li>
<li>Confirms authorization for decommissioning</li>
<li>Forwards to power-off stage if validation passes</li>
</ol>

<h4 id="sample-output">Sample Output</h4>

<pre><code>{
    "action": "poweroff_server",
    "status": "pending",
    "data": {
        "server_id": "SRV-12345",
        "server_details": {
            "hostname": "srv-web-01.datacenter.com",
            "ip_address": "192.168.1.100",
            "location": "DC1-Rack-15-U20",
            "serial_number": "ABC123456789"
        },
        "portal_check_result": {
            "server_exists": true,
            "status": "eligible_for_demise",
            "last_activity": "2025-10-15T09:30:00Z"
        }
    },
    "message": "Server SRV-12345 verified and ready for power-off"
}
</code></pre>

<h3 id="server-poweroff-processor">2ï¸âƒ£ Server Power Off Processor</h3>

<h4 id="purpose-2">Purpose</h4>

<p>Safely powers down the server using IPMI/BMC remote management protocols.</p>

<h4 id="input-data-requirements-2">Input Data Requirements</h4>

<ul>
<li><code>server_id</code> (required): Server to power off</li>
<li><code>server_details</code> (required): IP address and management credentials</li>
<li><code>portal_check_result</code> (optional): Previous validation results</li>
</ul>

<h4 id="processing-logic-2">Processing Logic</h4>

<ol>
<li>Connects to server management interface (IPMI/BMC)</li>
<li>Checks current power status</li>
<li>Executes graceful shutdown if server is powered on</li>
<li>Verifies power-off completion</li>
<li>Forwards to cooling period stage</li>
</ol>

<h4 id="power-off-methods">Power Off Methods</h4>

<ul>
<li><strong>IPMI</strong>: Industry standard protocol for server management</li>
<li><strong>BMC</strong>: Baseboard Management Controller interface</li>
<li><strong>Graceful Shutdown</strong>: OS-level shutdown before power off</li>
<li><strong>Verification</strong>: Confirms power state after operation</li>
</ul>

<h4 id="sample-output-2">Sample Output</h4>

<pre><code>{
    "action": "start_cooling_period",
    "status": "pending",
    "data": {
        "server_id": "SRV-12345",
        "poweroff_result": {
            "success": true,
            "power_status": "off",
            "poweroff_method": "IPMI",
            "execution_time": "4.5s",
            "verification": "confirmed_off"
        },
        "poweroff_timestamp": "2025-11-02T12:05:00.000000"
    },
    "message": "Server SRV-12345 powered off successfully. Starting 48-hour cooling period."
}
}
</code></pre>

<h3 id="server-cooling-processor">2ï¸âƒ£.5ï¸âƒ£ Server Cooling Period Processor</h3>

<h4 id="purpose-3">Purpose</h4>

<p>Enforces a mandatory 48-hour cooling period after server power-off with continuous power status monitoring.</p>

<h4 id="input-data-requirements-3">Input Data Requirements</h4>

<ul>
<li><code>server_id</code> (required): Server undergoing cooling period</li>
<li><code>server_details</code> (required): Server management information</li>
<li><code>poweroff_timestamp</code> (required): When server was powered off</li>
<li><code>poweroff_result</code> (optional): Power-off operation results</li>
</ul>

<h4 id="processing-logic-3">Processing Logic</h4>

<ol>
<li>Starts 48-hour cooling period timer</li>
<li>Creates background monitoring thread</li>
<li>Performs power status checks every 2 hours</li>
<li>Detects cooling period violations (server powers on)</li>
<li>Forwards to demise stage after successful cooling</li>
</ol>

<h4 id="cooling-period-features">Cooling Period Features</h4>

<ul>
<li><strong>48-Hour Duration</strong>: Mandatory cooling period for all servers</li>
<li><strong>2-Hour Monitoring</strong>: Regular power status checks via IPMI</li>
<li><strong>Violation Detection</strong>: Immediate error if server powers on during cooling</li>
<li><strong>Background Processing</strong>: Non-blocking thread-based monitoring</li>
<li><strong>Session Management</strong>: Thread-safe tracking of multiple cooling sessions</li>
</ul>

<h4 id="sample-output-3">Sample Output</h4>

<div style="background: #d4edda; border: 1px solid #c3e6cb; padding: 15px; margin: 10px 0; border-radius: 5px;">
<strong>Success Case (After 48 hours):</strong>
<pre><code>{
    "action": "demise_server",
    "status": "pending",
    "data": {
        "server_id": "SRV-12345",
        "cooling_completion": {
            "cooling_start": "2025-11-02T12:05:00.000000",
            "cooling_end": "2025-11-04T12:05:00.000000",
            "total_checks_performed": 24,
            "cooling_duration_hours": 48
        }
    },
    "message": "Server SRV-12345 completed 48-hour cooling period successfully. Proceeding to demise."
}
</code></pre>
</div>

<div style="background: #f8d7da; border: 1px solid #f5c6cb; padding: 15px; margin: 10px 0; border-radius: 5px;">
<strong>Violation Case (Server powers on during cooling):</strong>
<pre><code>{
    "action": "cooling_violation_error",
    "status": "violation_error",
    "data": {
        "server_id": "SRV-12345",
        "violation_details": {
            "violation_time": "2025-11-03T08:30:00.000000",
            "cooling_elapsed_hours": 20.4,
            "remaining_hours": 27.6,
            "power_on_reason": "manual_power_on"
        }
    },
    "error": "Server SRV-12345 powered on during mandatory cooling period",
    "message": "CRITICAL: Server SRV-12345 violated cooling period by powering on. Demise process terminated.",
    "pipeline_complete": true,
    "violation": true
}
</code></pre>
</div>

<h3 id="server-demise-processor">3ï¸âƒ£ Server Demise Processor</h3>

<h4 id="purpose-4">Purpose</h4>

<p>Executes the final server decommissioning process, including portal updates and asset management.</p>

<h4 id="input-data-requirements-4">Input Data Requirements</h4>

<ul>
<li><code>server_id</code> (required): Server to decommission</li>
<li><code>server_details</code> (required): Complete server information</li>
<li><code>cooling_completion</code> (optional): Cooling period results</li>
<li><code>original_request</code> (optional): Initial request context</li>
</ul>

<h4 id="processing-logic-4">Processing Logic</h4>

<ol>
<li>Updates server status in portal system</li>
<li>Transfers or archives server assets and data</li>
<li>Removes server from monitoring systems</li>
<li>Updates inventory and asset management</li>
<li>Completes decommissioning workflow</li>
</ol>

<h4 id="demise-operations">Demise Operations</h4>

<ul>
<li><strong>Portal Updates</strong>: Mark server as decommissioned</li>
<li><strong>Asset Transfer</strong>: Move assignable assets to available pool</li>
<li><strong>Monitoring Cleanup</strong>: Remove from all monitoring systems</li>
<li><strong>Documentation</strong>: Update inventory and compliance records</li>
<li><strong>Audit Trail</strong>: Complete decommissioning audit log</li>
</ul>

<h4 id="sample-output-4">Sample Output</h4>

<pre><code>{
    "action": "demise_complete",
    "status": "success",
    "data": {
        "server_id": "SRV-12345",
        "demise_result": {
            "portal_updated": true,
            "assets_transferred": true,
            "monitoring_removed": true,
            "inventory_updated": true,
            "compliance_documented": true
        },
        "completion_timestamp": "2025-11-04T14:30:00.000000"
    },
    "message": "Server SRV-12345 decommissioned successfully. Pipeline complete.",
    "pipeline_step": 3,
    "pipeline_complete": true
}
</code></pre>

<hr />

<h2 id="docker-setup">ğŸ³ Complete Docker Setup</h2>

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; margin: 20px 0;">
<h3>ğŸš€ One-Click Deployment</h3>
<p>The system now supports complete containerized deployment with automated setup, health monitoring, and management scripts.</p>
<pre style="background: rgba(0,0,0,0.2); padding: 10px; border-radius: 4px; margin: 10px 0;"><code># Complete automated deployment
./deploy-docker.sh

# Or manual step-by-step
./docker-manage.sh build && ./docker-manage.sh up</code></pre>
</div>

<h3 id="services-overview">ğŸ“‹ Container Services Overview</h3>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #007bff;">
<h4 id="zookeeper-service">ğŸ”§ Zookeeper Service</h4>
<ul>
<li><strong>Image</strong>: <code>confluentinc/cp-zookeeper:7.4.0</code></li>
<li><strong>Port</strong>: 2181</li>
<li><strong>Purpose</strong>: Kafka coordination and metadata management</li>
<li><strong>Data Persistence</strong>: Named volume for data and logs</li>
<li><strong>Health Check</strong>: Built-in Confluent monitoring</li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
<h4 id="kafka-service">ğŸ“¡ Kafka Service</h4>
<ul>
<li><strong>Image</strong>: <code>confluentinc/cp-kafka:7.4.0</code></li>
<li><strong>Ports</strong>: 9092 (external), 29092 (internal)</li>
<li><strong>Purpose</strong>: Message streaming and topic management</li>
<li><strong>Dependencies</strong>: Zookeeper (with health check dependency)</li>
<li><strong>Configuration</strong>: Single broker with replication factor 1</li>
<li><strong>JMX Monitoring</strong>: Enabled on port 9101</li>
<li><strong>Health Check</strong>: kafka-broker-api-versions command</li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #6f42c1;">
<h4 id="kafka-ui-service">ğŸŒ Kafka UI Service</h4>
<ul>
<li><strong>Image</strong>: <code>provectuslabs/kafka-ui:latest</code></li>
<li><strong>Port</strong>: 8080</li>
<li><strong>Purpose</strong>: Web-based Kafka cluster management</li>
<li><strong>Features</strong>: Topic visualization, message browsing, consumer group monitoring</li>
<li><strong>Access</strong>: <a href="http://localhost:8080">http://localhost:8080</a></li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #dc3545;">
<h4 id="kafka-processors-service">âš™ï¸ Kafka Processors Service</h4>
<ul>
<li><strong>Build</strong>: Custom Dockerfile (Python 3.11-slim)</li>
<li><strong>Port</strong>: 8082</li>
<li><strong>Purpose</strong>: Main application (processors + REST API)</li>
<li><strong>Dependencies</strong>: Kafka service (waits for healthy status)</li>
<li><strong>Health Check</strong>: Dual endpoint monitoring (/health + /health/processors)</li>
<li><strong>Auto-restart</strong>: Unless-stopped policy</li>
<li><strong>Environment Variables</strong>: Kafka bootstrap servers override</li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #fd7e14;">
<h4 id="docs-service">ğŸ“š Documentation Service</h4>
<ul>
<li><strong>Image</strong>: <code>python:3.11-slim</code></li>
<li><strong>Port</strong>: 8090</li>
<li><strong>Purpose</strong>: Serves project documentation and guides</li>
<li><strong>Content</strong>: Complete system documentation, API guides, examples</li>
<li><strong>Access</strong>: <a href="http://localhost:8090">http://localhost:8090</a></li>
<li><strong>Health Check</strong>: HTTP response monitoring</li>
</ul>
</div>

</div>

<h3 id="docker-commands">Docker Commands</h3>

<pre><code># Build services
./docker-manage.sh build

# Start all services
./docker-manage.sh up

# View service status
./docker-manage.sh status

# View logs
./docker-manage.sh logs [service-name]

# Stop services
./docker-manage.sh down

# Clean up resources
./docker-manage.sh clean

# Open shell in container
./docker-manage.sh shell [service-name]
</code></pre>

<h3 id="environment-variables">Environment Variables</h3>

<p>The application supports environment variable overrides for Docker deployment:</p>

<ul>
<li><code>KAFKA_BOOTSTRAP_SERVERS</code>: Override Kafka connection string</li>
<li><code>KAFKA_HOST</code>: Kafka hostname for Docker networking</li>
<li><code>KAFKA_PORT</code>: Kafka port for health checks</li>
<li><code>API_HOST</code>: API server bind address</li>
<li><code>API_PORT</code>: API server port</li>
</ul>

<h3 id="volume-mounts">Volume Mounts</h3>

<ul>
<li><strong>Configuration</strong>: <code>./config:/app/config</code> (configuration files)</li>
<li><strong>Logs</strong>: <code>./logs:/app/logs</code> (application logs)</li>
<li><strong>Kafka Data</strong>: Named volumes for persistence</li>
</ul>

<hr />

<h2 id="health-monitoring">â¤ï¸ Health Monitoring & Status Tracking</h2>

<div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); color: white; padding: 20px; border-radius: 8px; margin: 20px 0;">
<h3>ğŸ” Comprehensive Health System</h3>
<p>The system includes multi-layer health monitoring with real-time status tracking, automatic failure detection, and recovery mechanisms.</p>
</div>

<h3 id="health-endpoints">ğŸŒ Health Check Endpoints</h3>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin: 20px 0;">

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
<h4>ğŸ¥ System Health Check</h4>
<p><strong>Endpoint</strong>: <code>GET /health</code></p>
<p><strong>Purpose</strong>: Comprehensive system status</p>
<p><strong>Monitors</strong>:</p>
<ul>
<li>Kafka connectivity</li>
<li>Processor manager status</li>
<li>API server health</li>
</ul>
<pre style="background: #e9ecef; padding: 8px; border-radius: 4px; font-size: 12px;"><code>curl http://localhost:8082/health | jq</code></pre>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #007bff;">
<h4>âš™ï¸ Processor Health Check</h4>
<p><strong>Endpoint</strong>: <code>GET /health/processors</code></p>
<p><strong>Purpose</strong>: Kafka processor status</p>
<p><strong>Monitors</strong>:</p>
<ul>
<li>Processor manager running status</li>
<li>Worker thread count</li>
<li>Process ID and uptime</li>
</ul>
<pre style="background: #e9ecef; padding: 8px; border-radius: 4px; font-size: 12px;"><code>curl http://localhost:8082/health/processors | jq</code></pre>
</div>

</div>

<h3 id="health-status-meanings">ğŸ“Š Health Status Meanings</h3>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">

<div style="background: #d4edda; border: 1px solid #c3e6cb; padding: 10px; border-radius: 5px;">
<strong>âœ… healthy</strong><br>
All systems operational
</div>

<div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px;">
<strong>â³ starting</strong><br>
Services initializing
</div>

<div style="background: #f8d7da; border: 1px solid #f5c6cb; padding: 10px; border-radius: 5px;">
<strong>ğŸ›‘ stopping</strong><br>
Graceful shutdown
</div>

<div style="background: #ffeaa7; border: 1px solid #f39c12; padding: 10px; border-radius: 5px;">
<strong>âš ï¸ degraded</strong><br>
Running with issues
</div>

<div style="background: #f8d7da; border: 1px solid #dc3545; padding: 10px; border-radius: 5px;">
<strong>âŒ not_running</strong><br>
Service not detected
</div>

<div style="background: #e2e3e5; border: 1px solid #6c757d; padding: 10px; border-radius: 5px;">
<strong>ğŸ”„ stale</strong><br>
Status outdated (>60s)
</div>

</div>

<h3 id="health-examples">ğŸ“‹ Health Check Examples</h3>

<h4>Healthy System Response</h4>
<pre style="background: #f8f9fa; padding: 15px; border-radius: 8px; overflow-x: auto;"><code>{
  "status": "healthy",
  "timestamp": "2025-11-02T14:35:39.627170",
  "services": {
    "kafka": "healthy",
    "processors": "healthy",
    "api": "healthy"
  }
}</code></pre>

<h4>Detailed Processor Status</h4>
<pre style="background: #f8f9fa; padding: 15px; border-radius: 8px; overflow-x: auto;"><code>{
  "status": "healthy",
  "timestamp": "2025-11-02T14:35:39.652052",
  "processor_status": "healthy",
  "processor_info": {
    "status": "running",
    "pid": 3815914,
    "timestamp": "2025-11-02T14:35:25.218260",
    "start_time": "2025-11-02T14:35:24.580216",
    "processors": 3,
    "executor_active": true
  },
  "message": "Kafka processors are running normally"
}</code></pre>

<h3 id="monitoring-automation">ğŸ¤– Automated Monitoring</h3>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #6f42c1;">
<h4>ğŸ³ Docker Health Checks</h4>
<ul>
<li>Built-in container health monitoring</li>
<li>Automatic container restart on failure</li>
<li>Health check intervals: 30 seconds</li>
<li>Startup grace period: 60 seconds</li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #dc3545;">
<h4>ğŸ“ Status File Tracking</h4>
<ul>
<li>Real-time processor status file updates</li>
<li>Heartbeat every 30 seconds</li>
<li>Process ID and thread count tracking</li>
<li>Automatic cleanup on shutdown</li>
</ul>
</div>

<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
<h4>ğŸ”„ Auto-Recovery</h4>
<ul>
<li>Docker service restart policies</li>
<li>Health check failure detection</li>
<li>Graceful shutdown handling</li>
<li>Dependency-aware restart ordering</li>
</ul>
</div>

</div>

<hr />

<h2 id="troubleshooting">ğŸ”§ Troubleshooting</h2>

<h3 id="common-issues-and-solutions">Common Issues and Solutions</h3>

<h4 id="1-port-conflicts">1. Port Conflicts</h4>

<p><strong>Problem</strong>: "Address already in use" error on port 8082
<strong>Solution</strong>:</p>

<pre><code># Find process using port
netstat -tulnp | grep :8082
# Kill process
kill &lt;PID&gt;
# Or change port in config/config.json
</code></pre>

<h4 id="2-kafka-connection-failed">2. Kafka Connection Failed</h4>

<p><strong>Problem</strong>: Cannot connect to Kafka broker
<strong>Solutions</strong>:
- Verify Kafka is running: <code>ps aux | grep kafka</code>
- Check port availability: <code>netstat -tulnp | grep :9092</code>
- Restart Kafka services:</p>

<pre><code>cd /root/kafka
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-17.0.16.0.8-2.el8.x86_64
bin/kafka-server-stop.sh
bin/kafka-server-start.sh config/server.properties
</code></pre>

<h4 id="3-python-import-errors">3. Python Import Errors</h4>

<p><strong>Problem</strong>: Module not found errors
<strong>Solutions</strong>:
- Install dependencies: <code>pip install -r requirements.txt</code>
- Check Python path: <code>export PYTHONPATH=/root/kafka/kafka-processors:$PYTHONPATH</code></p>

<h4 id="4-docker-build-issues">4. Docker Build Issues</h4>

<p><strong>Problem</strong>: Docker build failures
<strong>Solutions</strong>:
- Clean Docker cache: <code>./docker-manage.sh clean</code>
- Rebuild without cache: <code>docker-compose build --no-cache</code>
- Check Docker daemon: <code>systemctl status docker</code></p>

<h4 id="5-topic-not-found">5. Topic Not Found</h4>

<p><strong>Problem</strong>: Kafka topics don't exist
<strong>Solutions</strong>:
- Create topics manually:</p>

<pre><code>cd /root/kafka
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-17.0.16.0.8-2.el8.x86_64
bin/kafka-topics.sh --create --topic details-input \
    --bootstrap-server localhost:9092 --partitions 3 --replication-factor 1
</code></pre>

<ul>
<li>Or run setup script: <code>./setup-topics.sh</code> (Docker)</li>
</ul>

<h4 id="6-consumer-group-issues">6. Consumer Group Issues</h4>

<p><strong>Problem</strong>: Messages not being consumed
<strong>Solutions</strong>:
- Reset consumer group:</p>

<pre><code>bin/kafka-consumer-groups.sh --bootstrap-server localhost:9092 \
    --group details-processor-group --reset-offsets --to-earliest \
    --topic details-input --execute
</code></pre>

<h4 id="7-java-version-issues">7. Java Version Issues</h4>

<p><strong>Problem</strong>: Kafka fails to start due to Java version
<strong>Solution</strong>:</p>

<pre><code># Set correct Java version
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-17.0.16.0.8-2.el8.x86_64
# Add to ~/.bashrc for persistence
echo 'export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-17.0.16.0.8-2.el8.x86_64' &gt;&gt; ~/.bashrc
</code></pre>

<h3 id="debugging-commands">Debugging Commands</h3>

<pre><code># Check service status
systemctl status docker
ps aux | grep -E "(kafka|zookeeper)" | grep -v grep

# View application logs
tail -f /root/kafka/kafka-processors/logs/kafka-processors.log

# Monitor Kafka topics
cd /root/kafka
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-17.0.16.0.8-2.el8.x86_64
# Monitor input messages
bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 \
    --topic details-input --from-beginning
# Monitor output messages  
bin/kafka-console-consumer.sh --bootstrap-server localhost:9092 \
    --topic details-output --from-beginning

# Check API health
curl http://localhost:8082/health

# Test message sending
curl -X POST "http://localhost:8082/send-event" \
  -H "Content-Type: application/json" \
  -d '{"action": "show_details", "data": {"name": "Test"}}'
</code></pre>

<hr />

<h2 id="examples">Examples</h2>

<h3 id="example-1-show-details-request">Example 1: Show Details Request</h3>

<p><strong>Request</strong>:</p>

<pre><code>curl -X POST "http://localhost:8082/send-event" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "show_details",
    "data": {
      "name": "Customer Record 001",
      "description": "Premium customer account",
      "created_date": "2024-01-15T10:30:00"
    }
  }'
</code></pre>

<p><strong>API Response</strong>:</p>

<pre><code>{
    "message_id": "550e8400-e29b-41d4-a716-446655440000",
    "status": "sent",
    "message": "Event sent successfully for processing. Action: show_details",
    "timestamp": "2024-11-02T12:00:00.123456"
}
</code></pre>

<p><strong>Processor Output</strong> (in <code>details-output</code> topic):</p>

<pre><code>{
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "original_action": "show_details",
    "processor": "ShowDetailsProcessor",
    "processor_id": "proc-uuid-123",
    "timestamp": "2024-11-02T12:00:01.234567",
    "status": "success",
    "data": {
        "id": "550e8400-e29b-41d4-a716-446655440000",
        "name": "Customer Record 001",
        "description": "Premium customer account",
        "created_date": "2024-01-15T10:30:00",
        "last_modified": "2024-11-02T12:00:01",
        "status": "active",
        "metadata": {
            "processed_by": "show_details_processor",
            "processing_time": 1699012801.234,
            "version": "1.0"
        }
    },
    "message": "Details retrieved successfully for ID: 550e8400-e29b-41d4-a716-446655440000"
}
</code></pre>

<h3 id="example-2-create-details-request">Example 2: Create Details Request</h3>

<p><strong>Request</strong>:</p>

<pre><code>curl -X POST "http://localhost:8082/send-event" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "create_details",
    "data": {
      "name": "New Customer Account",
      "description": "Standard business account",
      "category": "business",
      "email": "contact@company.com"
    }
  }'
</code></pre>

<p><strong>Processor Output</strong>:</p>

<pre><code>{
    "id": "req-uuid-456",
    "original_action": "create_details",
    "processor": "CreateDetailsProcessor",
    "processor_id": "proc-uuid-456",
    "timestamp": "2024-11-02T12:05:00.345678",
    "status": "success",
    "data": {
        "id": "rec-uuid-789",
        "original_request_id": "req-uuid-456",
        "name": "New Customer Account",
        "description": "Standard business account",
        "category": "business",
        "created_date": "2024-11-02T12:05:00",
        "last_modified": "2024-11-02T12:05:00",
        "status": "active",
        "version": 1,
        "metadata": {
            "processed_by": "create_details_processor",
            "processing_time": 1699012900.345,
            "created_from": "req-uuid-456"
        },
        "computed_fields": {
            "slug": "new-customer-account",
            "search_keywords": ["new", "customer", "account"],
            "creation_source": "kafka_processor"
        }
    },
    "message": "Record created successfully with ID: rec-uuid-789"
}
</code></pre>

<h3 id="example-3-update-details-request">Example 3: Update Details Request</h3>

<p><strong>Request</strong>:</p>

<pre><code>curl -X POST "http://localhost:8082/send-event" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "update_details",
    "data": {
      "name": "Updated Customer Name",
      "status": "premium",
      "description": "Upgraded to premium account"
    }
  }'
</code></pre>

<p><strong>Processor Output</strong>:</p>

<pre><code>{
    "id": "upd-uuid-321",
    "original_action": "update_details", 
    "processor": "UpdateDetailsProcessor",
    "processor_id": "proc-uuid-321",
    "timestamp": "2024-11-02T12:10:00.456789",
    "status": "success",
    "data": {
        "id": "upd-uuid-321",
        "name": "Updated Customer Name",
        "updated_fields": ["name", "status", "description"],
        "last_modified": "2024-11-02T12:10:00",
        "status": "premium",
        "version": 2,
        "metadata": {
            "processed_by": "update_details_processor",
            "processing_time": 1699013000.456,
            "update_count": 1,
            "original_data": {
                "name": "Updated Customer Name",
                "status": "premium",
                "description": "Upgraded to premium account"
            }
        }
    },
    "message": "Record updated successfully for ID: upd-uuid-321. Updated fields: name, status, description"
}
</code></pre>

<h3 id="example-4-batch-processing-request">Example 4: Batch Processing Request</h3>

<p><strong>Request</strong>:</p>

<pre><code>curl -X POST "http://localhost:8082/send-batch" \
  -H "Content-Type: application/json" \
  -d '[
    {
      "action": "create_details",
      "data": {"name": "Batch Record 1", "category": "test"}
    },
    {
      "action": "show_details", 
      "data": {"name": "Batch Record 2"}
    },
    {
      "action": "update_details",
      "data": {"name": "Updated Batch Record", "status": "active"}
    }
  ]'
</code></pre>

<p><strong>API Response</strong>:</p>

<pre><code>{
    "total_events": 3,
    "successful": 3,
    "failed": 0,
    "results": [
        {
            "message_id": "batch-uuid-1",
            "status": "sent",
            "message": "Event sent for action: create_details"
        },
        {
            "message_id": "batch-uuid-2", 
            "status": "sent",
            "message": "Event sent for action: show_details"
        },
        {
            "message_id": "batch-uuid-3",
            "status": "sent", 
            "message": "Event sent for action: update_details"
        }
    ],
    "timestamp": "2024-11-02T12:15:00.567890"
}
</code></pre>

<h3 id="example-5-error-handling">Example 5: Error Handling</h3>

<p><strong>Invalid Request</strong>:</p>

<pre><code>curl -X POST "http://localhost:8082/send-event" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "invalid_action",
    "data": {"test": "data"}
  }'
</code></pre>

<p><strong>Error Response</strong>:</p>

<pre><code>{
    "detail": "Invalid action. Must be one of: show_details, update_details, create_details"
}
</code></pre>

<p><strong>Validation Error</strong> (create without required name):</p>

<pre><code>curl -X POST "http://localhost:8082/send-event" \
  -H "Content-Type: application/json" \
  -d '{
    "action": "create_details",
    "data": {"description": "Missing name field"}
  }'
</code></pre>

<p><strong>Processor Error Output</strong>:</p>

<pre><code>{
    "id": "err-uuid-999",
    "original_action": "create_details",
    "processor": "CreateDetailsProcessor",
    "processor_id": "proc-uuid-999",
    "timestamp": "2024-11-02T12:20:00.678901",
    "status": "error",
    "data": {
        "missing_fields": ["name"]
    },
    "message": "Missing required fields: name"
}
</code></pre>

<hr />

<h2 id="monitoring-and-maintenance">Monitoring and Maintenance</h2>

<h3 id="log-files">Log Files</h3>

<ul>
<li><strong>Application Logs</strong>: <code>/root/kafka/kafka-processors/logs/kafka-processors.log</code></li>
<li><strong>Kafka Server Logs</strong>: <code>/root/kafka/logs/kafka.log</code></li>
<li><strong>Zookeeper Logs</strong>: <code>/root/kafka/logs/zookeeper.log</code></li>
</ul>

<h3 id="health-monitoring">Health Monitoring</h3>

<ul>
<li><strong>API Health</strong>: <code>curl http://localhost:8082/health</code></li>
<li><strong>Kafka Topics</strong>: Monitor via Kafka UI at <code>http://localhost:8080</code> (Docker)</li>
<li><strong>System Resources</strong>: Monitor CPU, memory, and disk usage</li>
</ul>

<h3 id="performance-tuning">Performance Tuning</h3>

<ul>
<li>Adjust <code>threads</code> configuration per processor type</li>
<li>Modify Kafka <code>max_poll_records</code> for batch size optimization</li>
<li>Configure JVM memory settings for Kafka broker</li>
<li>Use appropriate partition counts for load distribution</li>
</ul>

<hr />

<h2 id="security-considerations">Security Considerations</h2>

<h3 id="production-deployment">Production Deployment</h3>

<ul>
<li>Use environment variables for sensitive configuration</li>
<li>Enable Kafka security features (SASL, SSL)</li>
<li>Implement API authentication and rate limiting</li>
<li>Use secure Docker image scanning</li>
<li>Regular security updates for dependencies</li>
</ul>

<h3 id="network-security">Network Security</h3>

<ul>
<li>Restrict access to Kafka ports (9092, 2181)</li>
<li>Use reverse proxy for API endpoints</li>
<li>Implement network segmentation</li>
<li>Monitor for unusual traffic patterns</li>
</ul>

<hr />

<p><em>This documentation provides comprehensive guidance for deploying, configuring, and maintaining the Kafka Processors System. For additional support or questions, refer to the inline code comments and test examples.</em></p>

            </main>
            
            <footer class="footer">
                <h3>ğŸ¯ System Information</h3>
                <p><strong>Status:</strong> <span class="badge badge-success">âœ… Fully Operational</span></p>
                <p><strong>Version:</strong> 1.0.0 | <strong>API Port:</strong> 8082 | <strong>Kafka Port:</strong> 9092</p>
                <p><strong>Generated:</strong> November 02, 2025 at 08:13 AM</p>
                
                <div class="developer">
                    <p><strong>ğŸ¨ Designed & Developed by</strong></p>
                    <p><strong>Mahesh Gavandar</strong></p>
                    <p style="font-size: 0.9em; opacity: 0.8;">Full-Stack Kafka Systems Developer</p>
                </div>
                
                <div style="margin-top: 20px; font-size: 0.9em; opacity: 0.8;">
                    <p>ğŸ“§ For support and inquiries about this Kafka Processors System</p>
                    <p>ğŸ”— <a href="Kafka_Processors_System_Documentation.html" style="color: #ff6b6b;">Complete Documentation</a> | 
                       <a href="File_Structure_Guide.html" style="color: #ff6b6b;">File Structure Guide</a></p>
                </div>
            </footer>
        </div>
        
        <a href="#" class="back-to-top" onclick="window.scrollTo({top: 0, behavior: 'smooth'}); return false;">â†‘</a>
        
        <script>
            // Show/hide back to top button
            window.addEventListener('scroll', function() {
                const backToTop = document.querySelector('.back-to-top');
                if (window.scrollY > 300) {
                    backToTop.style.display = 'flex';
                } else {
                    backToTop.style.display = 'none';
                }
            });
            
            // Smooth scrolling for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });
            
            // Add copy functionality to code blocks
            document.querySelectorAll('pre').forEach(pre => {
                const button = document.createElement('button');
                button.textContent = 'ğŸ“‹ Copy';
                button.style.cssText = 'position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3); padding: 5px 10px; border-radius: 4px; cursor: pointer; font-size: 12px;';
                
                const wrapper = document.createElement('div');
                wrapper.style.position = 'relative';
                pre.parentNode.insertBefore(wrapper, pre);
                wrapper.appendChild(pre);
                wrapper.appendChild(button);
                
                button.addEventListener('click', () => {
                    const code = pre.querySelector('code') || pre;
                    navigator.clipboard.writeText(code.textContent).then(() => {
                        button.textContent = 'âœ… Copied!';
                        setTimeout(() => button.textContent = 'ğŸ“‹ Copy', 2000);
                    });
                });
            });
        </script>
    </body>
    </html>
    